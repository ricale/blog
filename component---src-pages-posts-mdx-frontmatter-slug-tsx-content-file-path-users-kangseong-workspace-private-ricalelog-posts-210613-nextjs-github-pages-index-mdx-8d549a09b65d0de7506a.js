"use strict";(self.webpackChunkricalelog=self.webpackChunkricalelog||[]).push([[315],{3003:function(e,n,t){t.r(n),t.d(n,{Head:function(){return x},default:function(){return f}});var l=t(1151),a=t(7294);function o(e){const n=Object.assign({p:"p",a:"a",h2:"h2",code:"code",pre:"pre",h3:"h3",ol:"ol",li:"li",ul:"ul"},(0,l.ah)(),e.components);return a.createElement(a.Fragment,null,a.createElement(n.p,null,"간단한 프로토타이핑 공유를 위해, Next.js로 구현한 웹앱을 GitHub Pages에 배포하기로 했다."),"\n",a.createElement(n.p,null,a.createElement(n.a,{href:"https://taeny.dev/javascript/nextjs-with-deployment-platform/#3-netlify-vs-vercel"},"nextJS 뭘로 배포할까? (Netlify, Vercel, Github page)")," 문서를 보면 GitHub Pages는 물론이고 Netlify, Vercel 을 사용해 배포하는 방법과, 플랫폼간의 장단점까지 비교해 놓았다. 세 플랫폼에 모두 관심이 있다면 해당 글을 읽기를 권한다."),"\n",a.createElement(n.p,null,"이 글에서는 해당 글의 내용을 토대로 GitHub Pages에 배포하는 방법만 간략히 정리한다."),"\n",a.createElement(n.h2,null,"1. 배포 방법"),"\n",a.createElement(n.p,null,a.createElement(n.a,{href:"https://taeny.dev/javascript/nextjs-with-deployment-platform/#5--github-page-%EB%B0%B0%ED%8F%AC%ED%95%98%EA%B8%B0"},"위 문서"),"에서는 아래의 명령어를 ",a.createElement(n.code,null,"package.json"),"에 등록해놓고 사용하라고 안내하고 있다."),"\n",a.createElement(n.pre,null,a.createElement(n.code,{className:"language-js"},'"scripts": {\n  "deploy": "rm -rf node_modules/.cache && next build && next export && touch out/.nojekyll && git add out/ && git commit -m \\"Deploy Next.js to gh-pages\\" && git subtree push --prefix out origin gh-pages"\n},\n')),"\n",a.createElement(n.p,null,"명령어를 하나하나 살펴보면 아래와 같다."),"\n",a.createElement(n.pre,null,a.createElement(n.code,{className:"language-shell"},'rm -rf node_modules/.cache\nnext build\nnext export\ntouch out/.nojekyll\ngit add out/\ngit commit -m "Deploy Next.js to gh-pages"\ngit subtree push --prefix out origin gh-pages\n')),"\n",a.createElement(n.p,null,"(각 명령어에 관한 설명은 ",a.createElement(n.a,{href:"https://taeny.dev/javascript/nextjs-with-deployment-platform/#5--github-page-%EB%B0%B0%ED%8F%AC%ED%95%98%EA%B8%B0"},"원 문서"),"에 잘 되어있으므로 여기서는 생략하겠다.)"),"\n",a.createElement(n.p,null,"대부분의 경우 위 명령어를 그대로 써도 문제가 없겠지만, 개인적으로는 이슈가 몇 개 있었다."),"\n",a.createElement(n.h2,null,"2. 이슈"),"\n",a.createElement(n.h3,null,"2.1. 빌드 결과물을 git 스테이지에 추가"),"\n",a.createElement(n.p,null,"위에서는 ",a.createElement(n.code,null,"git add out/")," 명령어를 통해 빌드한 결과물을 git의 스테이지에 추가한다. 하지만 일반적인 Next.js 프로젝트에서 ",a.createElement(n.code,null,"out/")," 디렉토리는 ",a.createElement(n.code,null,".gitignore"),"에 등록되어있기 때문에, 해당 명령어로는 스테이지에 추가되지 않는다."),"\n",a.createElement(n.p,null,"해결 방법은 해당 디렉토리를 ",a.createElement(n.code,null,".gitignore"),"에서 제외시키거나 ",a.createElement(n.code,null,"-f")," 옵션을 주어서 ",a.createElement(n.code,null,".gitignore"),"와 관계 없이 강제로 추가시키는 것이다."),"\n",a.createElement(n.p,null,"여기서는 ",a.createElement(n.code,null,"-f")," 옵션을 사용한다. 왜냐면 빌드할 때만 ",a.createElement(n.code,null,"out/")," 디렉토리를 스테이지에 포함시키고, 빌드 후에는 삭제할 생각이기 때문이다."),"\n",a.createElement(n.h3,null,"2.2. 커밋 및 푸시"),"\n",a.createElement(n.p,null,"위 문서에서는 아래 명령어를 사용해 빌드 결과를 커밋하고 푸시한다."),"\n",a.createElement(n.pre,null,a.createElement(n.code,{className:"language-shell"},'git commit -m "Deploy Next.js to gh-pages"\ngit subtree push --prefix out origin gh-pages\n')),"\n",a.createElement(n.p,null,"이 경우 ",a.createElement(n.code,null,"out/")," 디렉토리의 내용물을 ",a.createElement(n.code,null,"main"),"(혹은 ",a.createElement(n.code,null,"master"),") 브랜치에 계속 유지해야 한다. ",a.createElement(n.code,null,"out/")," 디렉토리 내용을 git 에서 계속 유지할 것이라면 문제 없다. 하지만 내 경우 ",a.createElement(n.code,null,"out/")," 디렉토리의 내용을 ",a.createElement(n.code,null,"main")," 브랜치에 유지하고 싶지 않았다. (유지하지 않는 편이 히스토리 관리에 더 좋다고 생각했다.) 내가 원하는 프로세스는 아래와 같다."),"\n",a.createElement(n.ol,null,"\n",a.createElement(n.li,null,"git 스테이지에 임시로 ",a.createElement(n.code,null,"out/")," 디렉토리를 추가하고 커밋한다."),"\n",a.createElement(n.li,null,"해당 커밋을 가지고 ",a.createElement(n.code,null,"gh-pages")," 브랜치에 배포를 진행한다. (배포하면 ",a.createElement(n.code,null,"gh-pages")," 브랜치에 커밋이 새로 생성될 것이다.)"),"\n",a.createElement(n.li,null,"배포가 끝난 후 1번에서 추가했던 커밋을 삭제한다."),"\n"),"\n",a.createElement(n.p,null,"그럼 원하는 방향이 적용되게끔 명령어를 변경해보자."),"\n",a.createElement(n.pre,null,a.createElement(n.code,{className:"language-shell"},'# temp-for-deploy-gh-pages 브랜치를 생성한다.\ngit checkout -b temp-for-deploy-gh-pages\n\n# 생성한 브랜치에 `out/` 디렉토리가 포함된 내용을 커밋한다.\ngit commit -m "Deploy Next.js to gh-pages"\n\n# 해당 커밋을 사용해 `out/` 디렉토리만으로 로컬의 gh-pages 브랜치에 새로운 커밋을 만든다.\ngit subtree split --prefix out -b gh-pages\n\n# 로컬의 gh-pages를 강제로 gh-pages 에 푸시한다.\ngit push -f origin gh-pages:gh-pages\n\n# 로컬의 gh-pages 브랜치를 삭제한다.\ngit branch -D gh-pages\n\n# temp-for-deploy-gh-pages 브랜치를 삭제한다.\ngit checkout main\ngit branch -D temp-for-deploy-gh-pages\n')),"\n",a.createElement(n.p,null,a.createElement(n.code,null,"gh-pages"),"를 강제로 푸시하는 이유는 이미 원격에 ",a.createElement(n.code,null,"gh-pages")," 브랜치가 있을 경우, 새로운 커밋이 원격에 있는 기존의 커밋과 이어지지 않는 커밋이기 때문이다. (",a.createElement(n.code,null,"gh-pages"),"에 추가되는 커밋의 부모 커밋이 ",a.createElement(n.code,null,"main")," 브랜치 쪽에 유지되면, 이어지는 커밋으로 판단된다.)"),"\n",a.createElement(n.h2,null,"3. 이슈 해결 결과"),"\n",a.createElement(n.pre,null,a.createElement(n.code,{className:"language-shell"},'rm -rf node_modules/.cache\nnext build\nnext export\ntouch out/.nojekyll\ngit add -f out/\ngit checkout -b temp-for-deploy-gh-pages\ngit commit -m "Deploy Next.js to gh-pages"\ngit subtree split --prefix out -b gh-pages\ngit push -f origin gh-pages:gh-pages\ngit branch -D gh-pages\ngit checkout main\ngit branch -D temp-for-deploy-gh-pages\n')),"\n",a.createElement(n.p,null,"위 명령어들을 연달아 쓰면 Next.js 앱을 GitHub Pages에 배포할 수 있다. 매번 치기 귀찮을 것이므로 ",a.createElement(n.code,null,"package.json"),"에 등록해두고 사용하자."),"\n",a.createElement(n.pre,null,a.createElement(n.code,{className:"language-js"},'"scripts": {\n  "deploy-gh-pages": "rm -rf node_modules/.cache && next build && next export && touch out/.nojekyll && git add -f out/ && git checkout -b temp-for-deploy-gh-pages && git commit -m \\"Deploy Next.js to gh-pages\\" && git subtree split --prefix out -b gh-pages && git push -f origin gh-pages:gh-pages && git branch -D gh-pages && git checkout main && git branch -D temp-for-deploy-gh-pages"\n},\n')),"\n",a.createElement(n.h2,null,"4. 주의"),"\n",a.createElement(n.ul,null,"\n",a.createElement(n.li,null,'위 내용은 어디까지나 "프로토타이핑 공유를 위한 GitHub Pages 배포"를 목적으로 하고 있다. 다른 목적으로 사용할 경우 적절하지 않을 수 있다.'),"\n",a.createElement(n.li,null,"환경변수와 관련된 내용은 이 문서에서 정리하지 않았다. 해당 내용은 ",a.createElement(n.a,{href:"https://taeny.dev/javascript/nextjs-with-deployment-platform/#5--github-page-%EB%B0%B0%ED%8F%AC%ED%95%98%EA%B8%B0"},"원 문서"),"에 잘 설명되어 있다."),"\n"),"\n",a.createElement(n.h2,null,"References"),"\n",a.createElement(n.ul,null,"\n",a.createElement(n.li,null,a.createElement(n.a,{href:"https://taeny.dev/javascript/nextjs-with-deployment-platform/#3-netlify-vs-vercel"},"nextJS 뭘로 배포할까? (Netlify, Vercel, Github page)")),"\n",a.createElement(n.li,null,a.createElement(n.a,{href:"https://gist.github.com/tduarte/eac064b4778711b116bb827f8c9bef7b"},"tduarte/publish-ghpages.md")),"\n"))}var r,c,m=function(e){void 0===e&&(e={});const{wrapper:n}=Object.assign({},(0,l.ah)(),e.components);return n?a.createElement(n,e,a.createElement(o,e)):o(e)},i=t(1880),g=t(1883),p=t(3723),u=t(1858),s=t(3904),h=t(891);const d=e=>{let{data:n,children:t}=e;const{title:l,date:o,tags:r,heroImage:c,heroImageAlt:m}=n.mdx.frontmatter,i=c?(0,p.c)(c):null;return a.createElement(u.Z,null,a.createElement("h1",null,l),a.createElement(E,null,r.map((e=>a.createElement("li",{key:e},a.createElement(g.rU,{to:"/tags/"+e},e))))),a.createElement("div",null,o),!!i&&a.createElement(p.G,{image:i,alt:null!=m?m:""}),a.createElement(b,null,t))},E=h.ZP.ul(r||(r=(0,i.Z)(["\n  display: flex;\n  flex-direction: row;\n  flex-wrap: wrap;\n  gap: ","px;\n\n  margin: 0;\n  padding: 0;\n  list-style: none;\n\n  > li {\n    padding: ","px ","px\n      0px;\n    border-radius: 2px;\n\n    background-color: ",";\n    color: ",";\n\n    > a {\n      text-decoration: none;\n    }\n  }\n"])),(e=>e.theme.dimens.gutter),(e=>e.theme.dimens.thin),(e=>e.theme.dimens.gutter),(e=>e.theme.colors.tag),(e=>e.theme.colors.onTag)),b=h.ZP.div(c||(c=(0,i.Z)(["\n  word-break: keep-all;\n\n  h1,\n  h2,\n  h3,\n  h4,\n  h5,\n  h6,\n  p {\n    padding: 0;\n  }\n\n  h1 {\n    margin-top: ","px;\n    margin-bottom: ","px;\n  }\n\n  h2 {\n    margin-top: ","px;\n    margin-bottom: ","px;\n  }\n\n  h3 {\n    margin-top: ","px;\n    margin-bottom: ","px;\n  }\n\n  h4,\n  h5,\n  h6,\n  p,\n  blockquote,\n  pre,\n  ul,\n  ol,\n  table {\n    margin-top: ","px;\n    margin-bottom: ","px;\n  }\n\n  li > ul,\n  li > ol {\n    margin-top: 0;\n    margin-bottom: 0;\n  }\n\n  blockquote {\n    position: relative;\n\n    margin-left: 0;\n    margin-right: 0;\n    padding: 16px 30px;\n    border-left: 1px solid ",";\n    border-left-width: 10px;\n\n    background-color: ",";\n\n    > :first-child {\n      margin-top: 0;\n    }\n    > :last-child {\n      margin-bottom: 0;\n    }\n    > ul,\n    > ol {\n      padding-left: 20px;\n    }\n  }\n\n  blockquote:before {\n    content: '\"';\n\n    position: absolute;\n    top: 15px;\n    left: 5px;\n\n    font-size: 3rem;\n    color: ",";\n  }\n  blockquote:after {\n    content: '\"';\n\n    position: absolute;\n    bottom: -15px;\n    right: 10px;\n\n    font-size: 3rem;\n    color: ",";\n  }\n\n  code {\n    padding: ","px\n      ","px ","px;\n    border-radius: 2px;\n\n    font-size: 0.875em;\n\n    background-color: ",";\n    color: ",";\n  }\n\n  pre {\n    margin: ","px 0;\n    padding: ","px;\n\n    background-color: ",";\n    color: ",";\n    line-height: 140%;\n    overflow-x: auto;\n  }\n\n  pre > code {\n    padding: unset;\n    border-radius: unset;\n    background-color: unset;\n    color: unset;\n  }\n\n  table {\n    border-collapse: collapse;\n    td,\n    th {\n      border: 1px solid ",";\n      padding: ","px\n        ","px;\n    }\n  }\n"])),(e=>3.5*e.theme.dimens.margin),(e=>e.theme.dimens.margin),(e=>3*e.theme.dimens.margin),(e=>e.theme.dimens.margin),(e=>2.5*e.theme.dimens.margin),(e=>e.theme.dimens.margin),(e=>e.theme.dimens.margin),(e=>e.theme.dimens.margin),(e=>e.theme.colors.blockquoteBorder),(e=>e.theme.colors.blockquote),(e=>e.theme.colors.blockquoteBorder),(e=>e.theme.colors.blockquoteBorder),(e=>e.theme.dimens.spacing),(e=>e.theme.dimens.spacing),(e=>e.theme.dimens.thin),(e=>e.theme.colors.code),(e=>e.theme.colors.onCode),(e=>e.theme.dimens.margin),(e=>e.theme.dimens.margin),(e=>e.theme.colors.codeblock),(e=>e.theme.colors.onCodeblock),(e=>e.theme.colors.tableBorder),(e=>e.theme.dimens.spacing),(e=>e.theme.dimens.gutter)),x=e=>{let{data:n}=e;return a.createElement(s.Z,{title:n.mdx.frontmatter.title})};function f(e){return a.createElement(d,e,a.createElement(m,e))}}}]);
//# sourceMappingURL=component---src-pages-posts-mdx-frontmatter-slug-tsx-content-file-path-users-kangseong-workspace-private-ricalelog-posts-210613-nextjs-github-pages-index-mdx-8d549a09b65d0de7506a.js.map